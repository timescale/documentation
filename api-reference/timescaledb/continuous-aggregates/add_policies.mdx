---
title: add_policies()
description: Add refresh, compression, and data retention policies on a continuous aggregate
topics: [continuous aggregates, jobs, compression, data retention]
keywords: [continuous aggregates, policies, add, compress, data retention]
license: community
type: function
experimental: true
products: [cloud, self_hosted, mst]
---

import { CAGG, HYPERTABLE, CHUNK } from '/snippets/vars.mdx';

<Icon icon="flask" /> Early access

Add refresh, compression, and data retention policies to a {CAGG}
in one step. The added compression and retention policies apply to the
{CAGG}, _not_ to the original {HYPERTABLE}.

```sql
timescaledb_experimental.add_policies(
     relation REGCLASS,
     if_not_exists BOOL = false,
     refresh_start_offset "any" = NULL,
     refresh_end_offset "any" = NULL,
     compress_after "any" = NULL,
     drop_after "any" = NULL)
) RETURNS BOOL
```

<Note>
`add_policies()` does not allow the `schedule_interval` for the {CAGG} to be set, instead using a default value of 1
hour.

If you would like to set this add your policies manually (see
[`add_continuous_aggregate_policy`][add_continuous_aggregate_policy]).
</Note>

## Samples

Given a {CAGG} named `example_continuous_aggregate`, add three
policies to it:

1.  Regularly refresh the {CAGG} to materialize data between 1 day
    and 2 days old.
1.  Compress data in the {CAGG} after 20 days.
1.  Drop data in the {CAGG} after 1 year.

```sql
SELECT timescaledb_experimental.add_policies(
    'example_continuous_aggregate',
    refresh_start_offset => '1 day'::interval,
    refresh_end_offset => '2 day'::interval,
    compress_after => '20 days'::interval,
    drop_after => '1 year'::interval
);
```

## Arguments

| Name | Type | Default | Required | Description |
|-|-|-|-|-|
| `relation` | `REGCLASS` | - | âœ” | The {CAGG} that the policies should be applied to |
| `if_not_exists` | `BOOL` | false | - | When true, prints a warning instead of erroring if the {CAGG} doesn't exist. |
| `refresh_start_offset` | `INTERVAL` or `INTEGER` | - | - | The start of the {CAGG} refresh window, expressed as an offset from the policy run time. |
| `refresh_end_offset` | `INTERVAL` or `INTEGER` | - | - | The end of the {CAGG} refresh window, expressed as an offset from the policy run time. Must be greater than `refresh_start_offset`. |
| `compress_after` | `INTERVAL` or `INTEGER` | - | - | {CAGG} {CHUNK}s are compressed if they exclusively contain data older than this interval. |
| `drop_after` | `INTERVAL` or `INTEGER` | - | - | {CAGG} {CHUNK}s are dropped if they exclusively contain data older than this interval. |

For arguments that could be either an `INTERVAL` or an `INTEGER`, use an
`INTERVAL` if your time bucket is based on timestamps. Use an `INTEGER` if your
time bucket is based on integers.

## Returns

Returns `true` if successful.

[add_continuous_aggregate_policy]: /api-reference/timescaledb/continuous-aggregates/add_continuous_aggregate_policy
