---
title: state_periods()
description: Get the time periods corresponding to a given state from a state aggregate
license: community
type: function
toolkit: true
topics: [hyperfunctions]
hyperfunction:
  family: state tracking
  type: accessor
  aggregates:
    - state_agg()
---

<Icon icon="circle-play" iconType="duotone" /> Since 1.15.0

List the periods when the system is in a specific state from a state aggregate. Periods are defined by the start time
and end time.

If you have multiple state aggregates and need to interpolate the state across interval boundaries, use
[`interpolated_state_periods`][interpolated_state_periods].

```sql
state_periods(
    agg StateAgg,
    state [TEXT | BIGINT]
) RETURNS (TIMESTAMPTZ, TIMESTAMPTZ)
```

## Samples

Create a state aggregate and list all periods corresponding to the state `OK`.

```sql
SELECT start_time, end_time FROM state_periods(
  (SELECT state_agg(ts, state) FROM states_test),
  'OK',
);
```

Returns:

```
       start_time       |        end_time
------------------------+------------------------
 2020-01-01 00:00:11+00 | 2020-01-01 00:01:00+00
 2020-01-01 00:01:03+00 | 2020-01-01 00:02:00+00
```

[state_agg]: /api-reference/timescaledb/hyperfunctions/state-tracking/state_agg/state_agg
[interpolated_state_periods]: /api-reference/timescaledb/hyperfunctions/state-tracking/state_agg/interpolated_state_periods
## Arguments

| Name | Type | Default | Required | Description |
|------|------|---------|----------|-------------|
| agg | StateAgg | - | ✔ | A state aggregate created using [`state_agg`][state_agg] |
| state | TEXT \| BIGINT | - | ✔ | The target state to get data for |

## Returns

| Column | Type | Description |
|--------|------|-------------|
| start_time | TIMESTAMPTZ | The time when the state started (inclusive) |
| end_time | TIMESTAMPTZ | The time when the state ended (exclusive) |

