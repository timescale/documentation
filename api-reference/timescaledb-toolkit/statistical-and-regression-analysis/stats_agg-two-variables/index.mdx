---
title: stats_agg (two variables) overview
sidebarTitle: Overview
description: Statistical analysis and linear regression functions for two-dimensional data
topics: [hyperfunctions]
license: community
toolkit: true
products: [cloud, mst, self_hosted]
---

<Icon icon="circle-play" iconType="duotone" /> Since 1.3.0

Perform linear regression analysis, for example to calculate correlation coefficient and covariance, on two-dimensional
data. You can also calculate common statistics, such as average and standard deviation, on each dimension separately.
These functions are similar to the PostgreSQL statistical aggregates, but they include more features and are easier to
use in continuous aggregates and window functions. The linear regressions are based on the standard least-squares
fitting method.

These functions work on two-dimensional data. To work with one-dimensional data, for example to calculate the average
and standard deviation of a single variable, see [the one-dimensional `stats_agg` functions][stats_agg-1d].

import TwoStepAggregation from '/snippets/api-reference/timescaledb/hyperfunctions/_two-step-aggregation.mdx';

## Two-step aggregation

<TwoStepAggregation />

## Samples

### Calculate regression and statistical properties

Create a statistical aggregate that summarizes daily statistical data about two variables, `val2` and `val1`, where
`val2` is the dependent variable and `val1` is the independent variable. Use the statistical aggregate to calculate the
average of the dependent variable and the slope of the linear-regression fit:

```sql
WITH t AS (
    SELECT
        time_bucket('1 day'::interval, ts) AS dt,
        stats_agg(val2, val1) AS stats2D
    FROM foo
    WHERE id = 'bar'
    GROUP BY time_bucket('1 day'::interval, ts)
)
SELECT
    average_x(stats2D),
    slope(stats2D)
FROM t;
```

## Available functions

### Aggregate
- [`stats_agg()`][stats_agg]: aggregate data into an intermediate statistical aggregate form for further calculation

### Accessors for y variable statistics
- [`average_y()`][average_y_x]: calculate the average of the dependent variable from a statistical aggregate
- [`stddev_y()`][stddev_y_x]: calculate the standard deviation of the dependent variable from a statistical aggregate
- [`variance_y()`][variance_y_x]: calculate the variance of the dependent variable from a statistical aggregate
- [`skewness_y()`][skewness_y_x]: calculate the skewness of the dependent variable from a statistical aggregate
- [`kurtosis_y()`][kurtosis_y_x]: calculate the kurtosis of the dependent variable from a statistical aggregate
- [`sum_y()`][sum_y_x]: calculate the sum of the dependent variable from a statistical aggregate

### Accessors for regression analysis
- [`corr()`][corr]: calculate the correlation coefficient from a statistical aggregate
- [`covariance()`][covariance]: calculate the covariance from a statistical aggregate
-  [`determination_coeff()`][determination_coeff]: calculate the coefficient of determination (RÂ²) from a statistical
  aggregate
- [`slope()`][slope]: calculate the slope of the linear regression line from a statistical aggregate
- [`intercept()`][intercept]: calculate the y-intercept of the linear regression line from a statistical aggregate
- [`x_intercept()`][x_intercept]: calculate the x-intercept of the linear regression line from a statistical aggregate

### Accessors for aggregate information
- [`num_vals()`][num_vals]: get the number of values contained in a statistical aggregate

### Rollup
- [`rollup()`][rollup]: combine multiple two-dimensional statistical aggregates

### Mutator
- [`rolling()`][rolling]: create a rolling window aggregate for use in window functions

[two-step-aggregation]: #two-step-aggregation
[stats_agg-1d]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-one-variable/index
[stats_agg]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/stats_agg
[average_y_x]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/average_y_x
[stddev_y_x]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/stddev_y_x
[variance_y_x]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/variance_y_x
[skewness_y_x]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/skewness_y_x
[kurtosis_y_x]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/kurtosis_y_x
[sum_y_x]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/sum_y_x
[corr]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/corr
[covariance]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/covariance
[determination_coeff]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/determination_coeff
[slope]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/slope
[intercept]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/intercept
[x_intercept]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/x_intercept
[num_vals]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/num_vals
[rollup]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/rollup
[rolling]: /api-reference/timescaledb/hyperfunctions/statistical-and-regression-analysis/stats_agg-two-variables/rolling